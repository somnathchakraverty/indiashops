!function(t){"use strict";function i(t){window.console&&console.log(t)}t.fn.simpleLens=function(s){var e=t.extend({},t.fn.simpleLens.defaults,s),n={init:function(t){this.height=t.height(),this.width=t.width(),this.offset=t.offset(),this.position=t.position(),this.calc_image_limits()},calc_image_limits:function(){this.limits={x_left:this.position.left,x_right:this.position.left+this.width,y_top:this.position.top,y_bottom:this.position.top+this.height}},calc_view_position:function(t){return{org_x:t.pageX-this.offset.left,org_y:t.pageY-this.offset.top}}},o={init:function(t,i,s,e){this.parent_anchor=t,this.lens_container=i,this.ratio=s,this.cursor_position={top:0,left:0},this.calc_cursor_size(),this.insert_cursor(e.org_x,e.org_y)},destroy:function(){t("."+e.cursor_class).remove()},calc_cursor_size:function(){this.cursor_height=this.lens_container.height()/this.ratio.x,this.cursor_width=this.lens_container.width()/this.ratio.y,this.height_center=this.cursor_height/2,this.width_center=this.cursor_width/2},update_cursor_position:function(t,i){var s=i-this.height_center,e=i+this.height_center,o=t-this.width_center,r=t+this.width_center,a=n.limits;parseFloat(a.y_top)>parseFloat(s)?s=a.y_top:parseFloat(e)>parseFloat(a.y_bottom)&&(s=a.y_bottom-this.cursor_height),parseFloat(a.x_left)>parseFloat(o)?o=a.x_left:parseFloat(r)>parseFloat(a.x_right)&&(o=a.x_right-this.cursor_width),this.cursor_position={top:s,left:o,center_top:s+this.height_center,center_left:o+this.width_center},void 0!==this.cursor&&this.cursor.css(this.cursor_position)},insert_cursor:function(i,s){return this.cursor=t("<div>",{class:e.cursor_class}),this.cursor.css({height:this.cursor_height+"px",width:this.cursor_width+"px"}),this.cursor.appendTo(this.parent_anchor),this.update_cursor_position(i,s)}},r={init:function(s){this.parent_anchor=s,this.parent_div=s.parent(e.parent_class),this.lens_image_url=s.attr(e.lens_image_attr),this.lens_container=t("<div>",{class:e.lens_class}),this.lens_image=t("<img>"),n.init(s.find(e.big_image_class)),void 0===this.lens_image_url&&(i("Cannot find lens image. URL: "+this.lens_image_url),i(that),i(s),i(lens_image_url))},update_lens_position:function(t){this.lens_image.css({top:t.top,left:t.left})},calc_lens_position:function(t){return{left:-1*(t.center_left*this.ratio.x-this.container.width),top:-1*(t.center_top*this.ratio.y-this.container.height)}},lens_event_bind:function(){var t=this;this.parent_anchor.mousemove(function(i){var s=n.calc_view_position(i);o.update_cursor_position(s.org_x,s.org_y),t.update_lens_position(t.calc_lens_position(o.cursor_position,t.ratio,t.container))})},lens_event_unbind:function(){void 0!==this.parent_anchor&&this.parent_anchor.unbind("mousemove")},destroy:function(){o.destroy(),void 0!==this.lens_container&&this.lens_container.length>0&&(t("."+e.lens_class).remove(),this.lens_event_unbind())},load:function(i){var s=this;this.lens_container.appendTo(this.parent_div);var r=this.lens_container.height()/2-25,a=t("<img>",{src:e.loading_image}).css("margin-top",r);this.lens_container.html(a),this.lens_image.load(function(){s.lens_container.html(s.lens_image),s.container={width:s.lens_container.width()/2,height:s.lens_container.height()/2},s.img_size={width:s.lens_image.width(),height:s.lens_image.height()},s.ratio={y:s.lens_image.height()/n.height,x:s.lens_image.width()/n.width};var t=n.calc_view_position(i);o.init(s.parent_anchor,s.lens_container,s.ratio,t),s.update_lens_position(s.calc_lens_position(o.cursor_position)),s.lens_event_bind()}).attr("src",this.lens_image_url)}};t(this).parents(e.parent_class).on(e.open_lens_event,e.anchor_parent_class,function(i){var s=t(this);r.init(s),r.load(i)}),t(this).parents(e.parent_class).on("mouseleave",e.anchor_parent_class,function(){r.destroy()})},t.fn.simpleLens.ver=function(){return"simpleLens-1.0.1"},t.fn.simpleLens.defaults={anchor_parent_class:".simleim",lens_image_attr:"data-lens-image",big_image_class:".simpbgim",parent_class:".simbgimcon",lens_class:"simpleLens-lens-element",cursor_class:"simpleLens-mouse-cursor",loading_image:"images/loading.gif",open_lens_event:"mouseenter"}}(jQuery);